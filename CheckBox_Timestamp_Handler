Sub CheckBox_Timestamp_Handler()
    Dim cb As CheckBox
    Dim targetAddress As String
    Dim targetCell As Range

    Set cb = ActiveSheet.CheckBoxes(Application.Caller)

    ' Extract the address from the checkbox's name (e.g., "CB_C2" â†’ "C2")
    targetAddress = Replace(cb.Name, "CB_", "")

    Set targetCell = ActiveSheet.Range(targetAddress)

    With targetCell
        If cb.Value = xlOff Then
            .Value = ""
        Else
            .Value = Format(Now, "yyyy-mm-dd hh:mm:ss")
            .HorizontalAlignment = xlRight
        End If
    End With
End Sub
