Sub AddLeftAlignedCheckboxes()
    Dim Rng As Range
    Dim SelectionRng As Range
    Dim WSHEET As Worksheet
    Dim cb As CheckBox

    Set WSHEET = ActiveSheet

    ' Prompt user to select a range
    Set SelectionRng = Application.InputBox( _
        "Select range to insert checkboxes (header will be skipped):", _
        "Checkbox Placement", Selection.Address, Type:=8)

    If SelectionRng Is Nothing Then Exit Sub

    Application.ScreenUpdating = False

    For Each Rng In SelectionRng.Cells
        If Rng.Row <> SelectionRng.Rows(1).Row Then ' skip header
            ' Remove existing checkbox if needed
            For Each cb In WSHEET.CheckBoxes
                If cb.TopLeftCell.Address = Rng.Address Then cb.Delete
            Next

            Set cb = WSHEET.CheckBoxes.Add(Rng.Left + 2, Rng.Top + 2, Rng.Width - 4, Rng.Height - 4)

            With cb
                .Caption = ""
                .Placement = xlMoveAndSize
                .OnAction = "CheckBox_Timestamp_Handler"
                .Tag = Rng.Offset(0, 1).Address  ' store target cell (right cell)
            End With
        End If
    Next

    Application.ScreenUpdating = True
End Sub
